<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Main.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">s0</a> &gt; <a href="index.source.html" class="el_package">CSVUtilities.commandLineUtility</a> &gt; <span class="el_source">Main.java</span></div><h1>Main.java</h1><pre class="source lang-java linenums">package CSVUtilities.commandLineUtility;

import CSVUtilities.CSVParser.FactoryFailureException;
import CSVUtilities.CSVSearcher.CSVSearcher;
import java.io.IOException;

/**
 * The Main class of our project. This is where execution begins. This command line program accepts
 * 2-6 (inclusive) arguments, which are explained in detail with the single --help or -h argument
 *
 * @author Stephen Rosa - 1/30/23 - Brown University CSCI0320 Spring '23
 * @version 1.0
 */
<span class="nc" id="L14">public final class Main {</span>
  /**
   * The initial method called when execution begins. Will try to parse command line arguments,
   * create a CSVSearcher from them, and search with it
   *
   * @param args An array of command line arguments
   */
  public static void main(String[] args) throws IOException, FactoryFailureException {
    // CSVSearcher &lt;filename&gt; &lt;value&gt; [[-index &lt;index&gt;] | [-headers [identifier]]]
    // parse our args (this will call search())
<span class="nc" id="L24">    parseArgs(args);</span>
<span class="nc" id="L25">  }</span>

  /**
   * Private method that parses args from main, checking for proper syntax. With the argument
   * specification described in --help/-h, only a handful of possible combinations of arguments are
   * correct - those are checked for here
   *
   * @param args the args passed via the commandline
   */
  private static void parseArgs(String[] args) throws IOException, FactoryFailureException {
    // local variables that will be set according to args
    // NOTE: there is an erroneous error warning if these variables are not initialized
    // and the values are instead set in every if-statement that doesn't result
    // in termination (through a call to printBadSyntax()). Therefore, I have
    // chosen to initialize the variables and thus some if-statements become
    // necessary or don't require me to update the values of the variables...
    // These initializations correspond to the args.length == 2 case, where
    // we just have a filename and a value to search for
<span class="nc" id="L43">    boolean headers = false;</span>
<span class="nc" id="L44">    String identifier = null;</span>
<span class="nc" id="L45">    int index = -1;</span>

    // NOTE: in the if statements, there are some comments that outline proper
    // syntax, such as &quot;// CSVSearcher &lt;filename&gt; &lt;value&gt;&quot;
    // these are examples of the only possible correct structure of the command
    // and its arguments, determined by the number of arguments and which args
    // are which flags, such as &quot;-header&quot; or &quot;-index&quot; being arg 3, 4, or 5, etc.

    // parse, verify input args
<span class="nc bnc" id="L54" title="All 2 branches missed.">    if (args.length == 0) {</span>
<span class="nc" id="L55">      printBadSyntax(&quot;Need at least &lt;filename&gt; and &lt;value&gt; arguments&quot;);</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">    } else if (args.length == 1) {</span>
<span class="nc bnc" id="L57" title="All 4 branches missed.">      if (args[0].equals(&quot;-h&quot;) || args[0].equals(&quot;--help&quot;)) {</span>
        // asked for help
<span class="nc" id="L59">        printHelp();</span>
      } else {
        // gave bad input
<span class="nc" id="L62">        printBadSyntax(&quot;Need at least &lt;filename&gt; and &lt;value&gt; arguments&quot;);</span>
      }
    }

    // args.length &gt; 1 --&gt; verify 1st and 2nd args aren't flags
<span class="nc bnc" id="L67" title="All 2 branches missed.">    if (args[0].equals(&quot;-headers&quot;)</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">        || args[0].equals(&quot;-index&quot;)</span>
<span class="nc bnc" id="L69" title="All 2 branches missed.">        || args[1].equals(&quot;-headers&quot;)</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">        || args[1].equals(&quot;-index&quot;)) {</span>
<span class="nc" id="L71">      printBadSyntax(&quot;First 2 arguments should be &lt;filename&gt; and &lt;value&gt;, not flags&quot;);</span>
    }

    // verify rest of args
<span class="nc bnc" id="L75" title="All 2 branches missed.">    if (args.length == 3) {</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">      if (args[2].equals(&quot;-headers&quot;)) {</span>
        // CSVSearcher &lt;filename&gt; &lt;value&gt; -headers
<span class="nc" id="L78">        headers = true;</span>
      } else {
<span class="nc" id="L80">        printBadSyntax(&quot;If supplying 3 arguments, 3rd argument must be '-headers'&quot;);</span>
      }
<span class="nc bnc" id="L82" title="All 2 branches missed.">    } else if (args.length == 4) {</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">      if (args[2].equals(&quot;-headers&quot;)) {</span>
        // CSVSearcher &lt;filename&gt; &lt;value&gt; -headers identifier
<span class="nc" id="L85">        headers = true;</span>
<span class="nc" id="L86">        identifier = args[3];</span>
<span class="nc" id="L87">        index = -2;</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">      } else if (args[2].equals(&quot;-index&quot;)) {</span>
        // CSVSearcher &lt;filename&gt; &lt;value&gt; -index index
<span class="nc" id="L90">        index = parseIndex(args, 2);</span>
      } else {
<span class="nc" id="L92">        printBadSyntax(</span>
            &quot;If supplying 4 arguments, 3rd and 4th arguments must be &quot;
                + &quot;'-headers identifier' or '-index index'&quot;);
      }
<span class="nc bnc" id="L96" title="All 2 branches missed.">    } else if (args.length == 5) {</span>
<span class="nc bnc" id="L97" title="All 4 branches missed.">      if (args[2].equals(&quot;-headers&quot;) &amp;&amp; args[3].equals(&quot;-index&quot;)) {</span>
        // CSVSearcher &lt;filename&gt; &lt;value&gt; -headers -index index
<span class="nc" id="L99">        index = parseIndex(args, 3);</span>
<span class="nc bnc" id="L100" title="All 4 branches missed.">      } else if (args[2].equals(&quot;-index&quot;) &amp;&amp; args[4].equals(&quot;-headers&quot;)) {</span>
        // CSVSearcher &lt;filename&gt; &lt;value&gt; -index index -headers
<span class="nc" id="L102">        index = parseIndex(args, 2);</span>
      } else {
<span class="nc" id="L104">        printBadSyntax(</span>
            &quot;If supplying 5 arguments, 3rd, 4th, and 5th arguments must be &quot;
                + &quot;'-headers -index index' or '-index index -headers'&quot;);
      }
<span class="nc" id="L108">      headers = true;</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">    } else if (args.length != 2) {</span>
<span class="nc" id="L110">      printBadSyntax(&quot;Can't supply more than 5 arguments&quot;);</span>
    }
    // build new CSVSearcher and return it with identifier and index!
<span class="nc" id="L113">    search(new CSVSearcher(args[0], headers), args[1], identifier, index);</span>
<span class="nc" id="L114">  }</span>

  /**
   * a method that parses the index from command line args. gets called when &quot;-index&quot; is found in
   * the arguments in a proper location - created to factor + clean up code
   *
   * @param args command line arguments
   * @param indexFlag the index (an int) into the args array at which &quot;index&quot; was found
   * @return the index (an int) which represents the column the user wants to search in the CSV
   *     table for the given value - see comments above index field in CSVSearcher for possible
   *     values
   */
  private static int parseIndex(String[] args, int indexFlag) {
<span class="nc" id="L127">    int index = -1;</span>
    try {
<span class="nc" id="L129">      index = Integer.parseInt(args[indexFlag + 1]);</span>
<span class="nc" id="L130">    } catch (NumberFormatException nfException) {</span>
      // not a number after -index
<span class="nc" id="L132">      printBadSyntax(&quot;Argument after -index must be a positive number&quot;);</span>
<span class="nc" id="L133">    }</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">    if (index &lt; 0) {</span>
      // negative number after -index
<span class="nc" id="L136">      printBadSyntax(&quot;Argument after -index must be a positive number&quot;);</span>
    }
<span class="nc" id="L138">    return index;</span>
  }

  /**
   * method that conducts searching after parsing
   *
   * @param searcher the CSVSearcher object created after parsing
   * @param value value to search for
   * @param identifier (optional) header name of which column to look for - see comments above
   *     identifier field in CSVSearcher for possible values
   * @param index (optional) index of which column to look for value in - see comments above index
   *     field in CSVSearcher for possible values
   */
  public static void search(CSVSearcher searcher, String value, String identifier, int index) {
    try {
<span class="nc" id="L153">      searcher.searchFile(value, identifier, index);</span>
<span class="nc" id="L154">    } catch (IllegalArgumentException e) {</span>
      // report errors
<span class="nc" id="L156">      System.err.println(&quot;CSVSearcher.searchFile() error: &quot; + e.getMessage());</span>
<span class="nc" id="L157">      System.exit(1);</span>
<span class="nc" id="L158">    }</span>
<span class="nc" id="L159">  }</span>

  /**
   * A method that prints the help information of this command line utility. Can be accessed with
   * &quot;--help&quot; or &quot;-h&quot; arguments from the command line
   */
  private static void printHelp() {
<span class="nc" id="L166">    System.out.println(</span>
        &quot;Stephen Rosa - 1/30/23 - Brown University CSCI0320 Spring '23\n&quot;
            + &quot;A command line utility that searches a CSV file by filename for a row containing a &quot;
            + &quot;specific value, optionally with parameters to narrow the search to specific column\n&quot;);
<span class="nc" id="L170">    System.out.println(</span>
        &quot;USAGE: *brackets represent optional arguments, carrots represent required arguments* \n&quot;
            + &quot;CSVSearcher &lt;filename&gt; &lt;value&gt; [[-index &lt;index&gt;] | [-headers [identifier]]]\n&quot;);
<span class="nc" id="L173">    System.out.println(</span>
        &quot;ARGUMENTS:\n&quot;
            + &quot;filename : the CSV file to be searched\n&quot;
            + &quot;value : the value to be searched for\n&quot;
            + &quot;-index &lt;index&gt; : optional flag that specifies which column to search for &lt;value&gt; (first column is index 0)\n&quot;
            + &quot;-headers [identifier]: optional flag that indicates the first row represents column headers, with additional &quot;
            + &quot;optional argument, [identifier], that specifies which column to search for &lt;value&gt;\n&quot;);
<span class="nc" id="L180">    System.out.println(</span>
        &quot;If -index index is supplied, but index is out of bounds for the CSV file supplied, an error will be thrown. &quot;
            + &quot;If n == -1, all columns will be searched\n&quot;);
<span class="nc" id="L183">    System.out.println(</span>
        &quot;If -headers identifier is supplied, but no header exists with the name identifier, an error will be thrown. &quot;
            + &quot;If there are multiple headers with the name identifier, the first one (leftmost) will be searched\n&quot;);
<span class="nc" id="L186">    System.out.println(</span>
        &quot;If you supply an index to be searched with -index index, you may not supply a header identifier, but you can &quot;
            + &quot;still indicate that there are headers in the CSV file with -headers (just not -headers identifier)\n&quot;);
<span class="nc" id="L189">    System.out.println(</span>
        &quot;If you supply -headers, the headers row (first row) will not be searched.\n&quot;);
<span class="nc" id="L191">    System.out.println(</span>
        &quot;Arguments with quotation marks are not supported - for example, searching for a value \&quot;with spaces like &quot;
            + &quot;this\&quot; or supplying a -header identifier where the identifier is \&quot;a header with spaces\&quot;.&quot;);
<span class="nc" id="L194">    System.exit(1);</span>
<span class="nc" id="L195">  }</span>

  /**
   * A method that prints a helpful error message when the command line command were improperly
   * formatted with incorrect arguments / improper syntax
   *
   * @param message the helpful part of the error message that describes what was wrong about the
   *     given arguments/syntax
   */
  private static void printBadSyntax(String message) {
<span class="nc" id="L205">    System.err.println(</span>
        &quot;src.main.edu.brown.cs.student.main.api.Main: improper syntax: \&quot;&quot;
            + message
            + &quot;\&quot; - check help for more details&quot;);
<span class="nc" id="L209">    System.err.println(&quot;(Use -h or --help for help)&quot;);</span>
<span class="nc" id="L210">    System.exit(1);</span>
<span class="nc" id="L211">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>